* native contact dmat print out 
*
set paramdir "/home/gns/Charmm/c35b1r1/toppar"

open unit 1 read form name @paramdir/"top_all27_prot_na.rtf"
read rtf card unit 1
close unit 1

open unit 1 read form name @paramdir/"par_all27_prot_na.prm"
read param card unit 1
close unit 1

prnlev 5
wrnlev 2

open read card name cl.pdb unit 1
read sequence pdb unit 1

generate CL setup

read coor pdb offset -111 unit 1 
close unit 1

! CL domain: residues 112-214

prnlev 6

! rename atoms to ensure pdb compatibility with charmm

rename atom cd1 select resname ile .and. type cd end
rename atom oxt select type ot1 end
rename atom o select ires ?nres .and. type ot2 end

read coor pdb offset -111 unit 1
close unit 1

print coor sele type oxt end

rename atom cd select resname ile .and. type cd1 end
rename atom ot1 select type oxt end
rename atom ot2 select ires ?nres .and. type o end

open write unit 9 card name cl-sasa.dat 

coor surface acce sele  all end
set index 1

label loop_res

scalar wmain stat select ires @index  end
set sas1 ?stot

coor stat sele ires @index end
set name1 = ?selresn

write title unit 9
* @index       @sas1      @name1
*
  
 incr index by 1
if index le ?nres goto loop_res

open unit 1 write card name cl.cor
write coor pdb unit 1 card
close unit 1


stop 
